import{d as f,b as _,f as l,A as h,o as d,c as i,i as v,_ as y}from"./index-CaBtS6-l.js";import{a as C}from"./axios-rFEYxPUp.js";const b=f("useMap",{state:()=>({shop:[],currentMarkerId:0}),getters:{get_all_shop:s=>s.shop},actions:{async loadAllShop(){await C.get("shop/",{}).then(s=>{this.shop=s.data})}}}),I={key:0},M=_({__name:"map",setup(s){const r=b(),n=l(!1),o=l(null),m=()=>{if(document.getElementById("yandex-maps-script"))return;const e=document.createElement("script");e.id="yandex-maps-script",e.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=fc906a8f-366e-48a2-8be7-17e554ed7bd2",e.async=!0,e.onload=()=>{n.value=!0,u()},document.body.appendChild(e)},u=async()=>{await r.loadAllShop(),ymaps.ready(()=>{var c;const e=new ymaps.Map(o.value,{center:[41.3114,69.280226],zoom:12,controls:["zoomControl","trafficControl","rulerControl"]}),a=new ymaps.GeoObjectCollection(null,{preset:"islands#dotIcon",iconColor:"#FE5000"});((c=r.shop)==null?void 0:c.map(t=>({coords:[t.longitude,t.latitude],id:t.id}))).forEach(t=>{let p=new ymaps.Placemark(t.coords,{},{preset:"islands#dotIcon"});p.id=t.id,a.add(p)}),e.geoObjects.add(a)})};return h(()=>{const e=new IntersectionObserver(a=>{a[0].isIntersecting&&!n.value&&(m(),e.disconnect())});if(o.value)e.observe(o.value);else{const a=setInterval(()=>{o.value&&(e.observe(o.value),clearInterval(a))},100)}}),(e,a)=>(d(),i("div",{ref_key:"mapContainer",ref:o,id:"map-placeholder"},[n.value?v("",!0):(d(),i("span",I," Карта загружается... "))],512))}}),w=y(M,[["__scopeId","data-v-847e1412"]]);export{w as M,b as u};
